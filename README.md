# 送货单对账单生成工具

自动合并所有送货单数据，生成透视分析报表和客户月度对账单。

## 两种使用方式

### 方式一：图形界面版（推荐）

1. **开发模式运行**：
   ```bash
   uv run gui_app.py
   ```

2. **打包成桌面程序**（无需Python环境）：
   - macOS/Linux: `./build.sh`
   - Windows: 双击 `build.bat`
   - 打包完成后在 `dist/` 文件夹找到可执行文件

3. **使用界面**：
   - 选择原始数据文件夹
   - 选择输出文件夹
   - 点击"生成对账单"
   - 查看实时日志输出

### 方式二：命令行版

1. 将所有送货单Excel文件放在 `raw-data` 目录下（支持子目录）

2. 运行脚本：
   ```bash
   uv run merge_delivery_orders.py
   ```

3. 查看 `output/` 文件夹中的生成文件

## 输出说明

### 1. 合并数据文件 (`merged_delivery_orders.xlsx`)

包含6个工作表：

- **汇总**：按产品规格汇总的数据
- **详细数据**：所有原始送货记录
- **按客户分析**：每个客户的订单数、总数量、总金额统计
- **按产品分析**：每种产品的销量、金额统计
- **按月份分析**：月度销售趋势分析
- **客户月度分析**：客户月度消费交叉分析

### 2. 对账单文件

按客户分文件夹组织：
```
output/
├── merged_delivery_orders.xlsx
├── 客户A/
│   ├── statement_客户A_2023-01.xlsx
│   └── statement_客户A_2023-02.xlsx
└── 客户B/
    └── statement_客户B_2023-01.xlsx
```

每个对账单包含：
- 公司抬头信息
- 送货明细表（日期、品名规格、单位、数量、单价、金额）
- 合计金额（中文大写和数字）
- 适配A4纸打印

## 功能特性

- ✅ 自动合并多个Excel送货单
- ✅ 生成多维度透视分析
- ✅ 按客户和月份自动生成对账单
- ✅ 品名规格自动换行
- ✅ A4纸打印适配
- ✅ 增量生成（跳过已存在的对账单）
- ✅ 图形界面操作（可选）
- ✅ 可打包成独立程序

## 环境要求

使用 uv 管理依赖：
- pandas - 数据处理
- openpyxl - Excel读写
- xlrd - 读取.xls文件
- pyinstaller - 打包工具（可选）

## 详细文档

- [BUILD_INSTRUCTIONS.md](BUILD_INSTRUCTIONS.md) - 打包和使用说明
