# 送货单对账单生成工具 - 打包说明

## 功能说明

这是一个桌面应用程序，用于：
1. 合并多个送货单Excel文件
2. 生成透视分析数据
3. 为每个客户生成月度对账单

## 打包步骤

### macOS/Linux

1. 确保已安装uv包管理器
2. 运行打包脚本：
   ```bash
   chmod +x build.sh
   ./build.sh
   ```
3. 打包完成后，可执行文件在 `dist/送货单对账单工具`

### Windows

1. 确保已安装uv包管理器
2. 双击运行 `build.bat`
3. 打包完成后，可执行文件在 `dist\送货单对账单工具.exe`

## 使用说明

### 运行GUI程序（开发模式）

```bash
uv run gui_app.py
```

### 使用打包后的程序

1. 双击运行可执行文件
2. 选择原始数据文件夹（包含送货单Excel文件）
3. 选择输出文件夹（对账单保存位置）
4. 点击"生成对账单"按钮
5. 等待处理完成，查看日志输出
6. 点击"打开输出文件夹"查看生成的文件

## 输出文件说明

### merged_delivery_orders.xlsx
包含6个工作表：
- 汇总：按产品规格汇总
- 详细数据：所有原始送货记录
- 按客户分析：客户维度统计
- 按产品分析：产品维度统计
- 按月份分析：月度统计
- 客户月度分析：客户月度交叉分析

### 对账单文件夹结构
```
output/
├── merged_delivery_orders.xlsx
├── 客户A/
│   ├── statement_客户A_2023-01.xlsx
│   └── statement_客户A_2023-02.xlsx
└── 客户B/
    └── statement_客户B_2023-01.xlsx
```

## 注意事项

1. 原始送货单Excel文件应放在指定的文件夹内（支持子文件夹）
2. 支持.xls和.xlsx格式
3. 如果对账单文件已存在，会自动跳过，不会覆盖
4. 首次运行可能需要较长时间，请耐心等待
5. 所有日志都会显示在界面上，可以查看处理进度

## 依赖包

- pandas: 数据处理
- openpyxl: Excel文件读写
- xlrd: 读取.xls文件
- pyinstaller: 打包工具
- tkinter: GUI界面（Python自带）

## 故障排除

### 打包失败
- 确保所有依赖包都已安装：`uv sync`
- 检查Python版本是否>=3.13

### 程序运行错误
- 检查原始数据文件夹路径是否正确
- 确保Excel文件格式符合要求
- 查看日志输出了解具体错误信息

## 开发者信息

如需修改程序功能：
- GUI界面代码：`gui_app.py`
- 核心处理逻辑：`merge_delivery_orders.py`
